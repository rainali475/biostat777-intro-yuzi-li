[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Me",
    "section": "",
    "text": "My name is Yuzi Li, and I’m a current first year PhD student in Biostatistics at BSPH. I like to play video games and watch anime in my free time.\n\n\n\nYuzi"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "Academic background\nI finished my undergraduate education at University of Toronto majoring in bioinformatics and biochemistry. I then completed my Master’s study at JHU in the Bioinformatics MS program. This year, I am starting my PhD in Biostatistics also here at Hopkins.\n\n\nResearch interests\nI am interested in using machine learning methods in genomics. My current project is on building a database (ChromBIRD) of predicted chromatin accessibility data integrated with data analysis tools.\nFor future projects, I want to integrate -omics data with other health-related data modalities to develop a predictive model for disease risks."
  },
  {
    "objectID": "example_analysis.html",
    "href": "example_analysis.html",
    "title": "Example Analysis",
    "section": "",
    "text": "Find out what kidney cortex genes are differentially expressed between biological sex groups."
  },
  {
    "objectID": "example_analysis.html#quarto",
    "href": "example_analysis.html#quarto",
    "title": "Example Analysis",
    "section": "",
    "text": "Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see https://quarto.org."
  },
  {
    "objectID": "example_analysis.html#running-code",
    "href": "example_analysis.html#running-code",
    "title": "Example Analysis",
    "section": "Running Code",
    "text": "Running Code\nWhen you click the Render button a document will be generated that includes both content and the output of embedded code. You can embed code like this:\n\n1 + 1\n\n[1] 2\n\n\nYou can add options to executable code like this\n\n\n[1] 4\n\n\nThe echo: false option disables the printing of code (only output is displayed)."
  },
  {
    "objectID": "example_analysis.html#question",
    "href": "example_analysis.html#question",
    "title": "Example Analysis",
    "section": "",
    "text": "Find out what kidney cortex genes are differentially expressed between biological sex groups."
  },
  {
    "objectID": "example_analysis.html#intended-audience",
    "href": "example_analysis.html#intended-audience",
    "title": "Example Analysis",
    "section": "Intended Audience",
    "text": "Intended Audience\nThe scientific community or researchers interested in sex-related differences in gene expression in kidney cortex."
  },
  {
    "objectID": "example_analysis.html#data-source",
    "href": "example_analysis.html#data-source",
    "title": "Example Analysis",
    "section": "Data source",
    "text": "Data source\nData is obtained from recount3 R package (Wilks et al. 2021), and the original data source is GTEx (Lonsdale et al. 2013).\n\n\n\n\n\nGTEx\n\n\nRecount3 study explorer: https://rna.recount.bio/ Recount3 R package: https://bioconductor.org/packages/release/bioc/html/recount3.html GTEx: https://gtexportal.org/home/\n\nData dictionary\nThe GTEx kidney study contains 98 samples coming from 96 subjects. The gene expression matrix contains 63856 ENSEMBL genes for each sample. Each sample is associated with sme metadata, and the data dictionary for the metadata is included below.\n\nDictionary for metadata\n\n\n\n\n\n\nTerm\nDescription\n\n\n\n\ngtex.sampid\nGTEx sample ID. This is unique for each sample. The format is GTEX-[donor ID]-[tissue site ID]-SM-[aliquot ID].\n\n\ngtex.subjid\nSubject ID.\n\n\ngtex.age\nAge of subject divided into age groups: 20-29, 30-39, 40-49, 50-59, 60-69, 70-79\n\n\ngtex.sex\nBiological sex of subject. 1 represents male, and 2 represents female.\n\n\ngtex.smtsd\nThe accurate site of sample. For kidney study, this includes “Kidney - Cortex” and “Kidney - Medulla”."
  },
  {
    "objectID": "example_analysis.html#data-analysis",
    "href": "example_analysis.html#data-analysis",
    "title": "Example Analysis",
    "section": "Data analysis",
    "text": "Data analysis\n\nGet data and metadata\nFirst, get metadata from recount3.\n\nmetadata &lt;- data.frame(rse@colData@listData)\nmetadata &lt;- metadata %&gt;% select(gtex.sampid, \n                                gtex.subjid, \n                                gtex.age, \n                                gtex.sex, \n                                gtex.smtsd)\nhead(metadata)\n\n               gtex.sampid gtex.subjid gtex.age gtex.sex      gtex.smtsd\n1 GTEX-14E6D-2526-SM-5YYA9  GTEX-14E6D    50-59        1 Kidney - Cortex\n2 GTEX-17F96-1926-SM-7MGWY  GTEX-17F96    70-79        1 Kidney - Cortex\n3 GTEX-1JMPZ-1226-SM-ARU8Y  GTEX-1JMPZ    30-39        1 Kidney - Cortex\n4 GTEX-12WSG-0826-SM-5EQ5A  GTEX-12WSG    50-59        2 Kidney - Cortex\n5  GTEX-ZE9C-1426-SM-4WKGM   GTEX-ZE9C    60-69        1 Kidney - Cortex\n6 GTEX-147F4-2626-SM-5Q5CS  GTEX-147F4    50-59        1 Kidney - Cortex\n\nnrow(metadata %&gt;% distinct(gtex.subjid))\n\n[1] 96\n\nmetadata %&gt;% count(gtex.age)\n\n  gtex.age  n\n1    20-29  5\n2    30-39  9\n3    40-49  9\n4    50-59 34\n5    60-69 37\n6    70-79  4\n\nmetadata %&gt;% count(gtex.sex)\n\n  gtex.sex  n\n1        1 76\n2        2 22\n\nmetadata %&gt;% count(gtex.smtsd)\n\n        gtex.smtsd  n\n1  Kidney - Cortex 94\n2 Kidney - Medulla  4\n\n\nGet gene expression data for GTEx kidney study from recount3. In the FPKM matrix, each row is a gene and each column is a sample.\n\n# Get FPKM from raw counts\ndeseq_obj &lt;- DESeqDataSet(rse, design = ~ as.factor(c(\"study\", \"external_id\")))\nfpkm_matrix &lt;- DESeq2::fpkm(deseq_obj)\n\n\n\nProcess data\nChange sex values in metadata to male and female.\n\nmetadata &lt;- metadata %&gt;% mutate_at(vars(gtex.sex), recode, \n                                   \"1\" = \"male\", \"2\" = \"female\")\n\nMatch FPKM matrix column names with sample IDs, exclude medulla samples, and exclude duplicate samples from same subject.\n\n\n\n\n\n\nNote\n\n\n\nNote that there are only 4 medulla samples, so excluding them would not largely reduce the number of samples.\n\n\n\ncolnames(fpkm_matrix) &lt;- gsub(\"\\\\.1\", \"\", colnames(fpkm_matrix))\nmetadata &lt;- metadata %&gt;% filter(gtex.smtsd == \"Kidney - Cortex\") %&gt;% \n  distinct(gtex.subjid, .keep_all = TRUE)\nfpkm_matrix &lt;- fpkm_matrix[, metadata$gtex.sampid]\nncol(fpkm_matrix)\n\n[1] 93\n\n\nRemove zero-variance genes.\n\nfpkm_matrix &lt;- fpkm_matrix[rowVars(fpkm_matrix) &gt; 0, ]\nnrow(fpkm_matrix)\n\n[1] 53798\n\n\nFit GAM model to log mean and log variance of expression, then keep only the top 5000 genes with high residual variance.\n\n\n\n\n\n\nTip\n\n\n\nHere, we filter genes with mean-adjusted variance instead of variance because genes that are highly expressed often have more variance in expression than genes that have low expression.\n\n\n\ngene_mean &lt;- rowMeans(fpkm_matrix)\ngene_var &lt;- rowVars(fpkm_matrix)\nmean_var_df &lt;- data.frame(X=gene_mean,Y=gene_var)\ngam_model &lt;- gam(formula = log2(x=Y) ~ s(log2(x=X)), data = mean_var_df)\ngene_sd_expect &lt;- sqrt(2^(gam_model$fitted.values))\ngene_var_norm &lt;- (fpkm_matrix - gene_mean)/gene_sd_expect\ngene_hyper_var &lt;- rowSums(gene_var_norm^2)/(ncol(fpkm_matrix) - 1)\n\nfpkm_matrix &lt;- fpkm_matrix[order(gene_hyper_var)[1:5000], ]\n\nCheck average log gene expression in female and male.\n\nfm_avg &lt;- rowMeans(log(fpkm_matrix[, metadata$gtex.sex == \"female\"] + 1))\nm_avg &lt;- rowMeans(log(fpkm_matrix[, metadata$gtex.sex == \"male\"] + 1))\nexpr_avg &lt;- data.frame(expression = c(m_avg, fm_avg), \n                       sex = as.factor(rep(c(\"male\", \"female\"), \n                                           each = nrow(fpkm_matrix))))\ng &lt;- ggplot(expr_avg, aes(expression)) + geom_histogram() + facet_wrap(vars(sex))\ng &lt;- g + labs(title = \"Mean expression comparison between sex\", \n              subtitle = \"Mean log FPKM in female and male kidneys\", \n              caption = \"Data source: GTEx\")\ng\n\n\n\n\n\n\n\n\n\n\nPCA\nUse PCA to explore gene expression data (Pearson 1901).\n\npca_res &lt;- prcomp(t(fpkm_matrix), scale. = TRUE)\ntop_pcs &lt;- data.frame(pca_res$x)\ng &lt;- ggplot(data = top_pcs, \n            mapping = aes(PC1, PC2, colour = as.factor(metadata$gtex.sex))) +\n  geom_point()\ng$labels$colour &lt;- \"Sex\"\ng &lt;- g + labs(colour = \"Sex\", \n              title = \"PCA plot\", \n              subtitle = \"Top two PCs of PCA on kidney samples gene expression\", \n              caption = \"Data source: GTEx\")\ng\n\n\n\n\n\n\n\n\n\nexplained_var &lt;- data.frame(t(summary(pca_res)$importance))\nexplained_var &lt;- explained_var[1:10, ]\nvar_plot &lt;- ggplot(data = explained_var, \n                   mapping = aes(factor(rownames(explained_var), \n                                        levels = rownames(explained_var)), \n                                 explained_var$Proportion.of.Variance, group=1))\nvar_plot &lt;- var_plot + geom_line() + geom_point()\nvar_plot &lt;- var_plot + labs(x = \"Principal Components\", \n                            y = \"Proportion of Variance Explained\", \n                            title = \"PCA exaplained variance\", \n                            subtitle = \"Proportions of variance explained by top 10 PCs\", \n                            caption = \"Based on GTEx kidney RNA-seq study\")\nvar_plot &lt;- var_plot + geom_text(aes(label=explained_var$Proportion.of.Variance),\n                                 vjust=-0.25)\nvar_plot\n\n\n\n\n\n\n\n\nThere is no clear separation of female and male subjects kidney gene expression from the top PCs.\n\n\nDifferential expression analysis\nUse Wilcoxon rank sum test to compare female and male expression of each gene in kidney.\n\ngroups &lt;- metadata$gtex.sex\nnames(groups) &lt;- metadata$gtex.sampid\n\nres &lt;- t(apply(fpkm_matrix, 1, function(i) {\n  tmptest &lt;- wilcox.test(i[groups==\"male\"],\n                         i[groups==\"female\"],\n                         alternative = \"two.sided\",\n                         var.equal = T)\n  c(tmptest$statistic, tmptest$p.value)\n}))\nFDR &lt;- p.adjust(res[,2],method=\"fdr\")\ndiff_logfc &lt;- rowMeans(log2(fpkm_matrix[, groups == \"female\"] + 1)) - \n  rowMeans(log2(fpkm_matrix[, groups == \"male\"] + 1))\ndiff_res &lt;- data.frame(statistics = res[,1],\n                       pvalue = res[,2],\n                       FDR = FDR,\n                       logFC = diff_logfc, \n                       stringsAsFactors = F)\ndiff_res[order(diff_res$FDR)[1:10],]\n\n                   statistics       pvalue          FDR        logFC\nENSG00000241859.6      1512.0 3.021754e-12 5.532180e-09 -0.002954730\nENSG00000251510.1      1501.5 5.532180e-12 5.532180e-09 -0.004263487\nENSG00000231535.5      1512.0 2.905205e-12 5.532180e-09 -0.008388644\nENSG00000092377.13     1501.5 5.532180e-12 5.532180e-09 -0.005932648\nENSG00000165246.13     1512.0 3.712517e-12 5.532180e-09 -0.013881424\nENSG00000229236.1      1494.0 9.726915e-12 7.442389e-09 -0.006092837\nENSG00000225117.1      1491.0 1.041934e-11 7.442389e-09 -0.006967552\nENSG00000225012.5      1480.5 1.941076e-11 1.213172e-08 -0.002876795\nENSG00000147050.14       38.0 4.314840e-11 2.397133e-08  0.047093209\nENSG00000229308.1      1464.0 5.473275e-11 2.736638e-08 -0.002405182\n\nsummary(diff_logfc)\n\n      Min.    1st Qu.     Median       Mean    3rd Qu.       Max. \n-2.648e-01 -1.379e-03 -7.197e-05 -8.789e-04  6.401e-04  9.640e-02 \n\n\nThe significant FDR values show that there are sex-related differences in kidney gene expression, but the small log fold change suggests that the differences are slight in terms of difference in amount of genes expressed.\n\n\nFunctions used\n\ndplyr\nselect, count, distinct, filter, pull\n\n\nggplot2\ngeom_histogram, geom_point, geom_line"
  },
  {
    "objectID": "example_analysis.html#summary",
    "href": "example_analysis.html#summary",
    "title": "Example Analysis",
    "section": "Summary",
    "text": "Summary\nIn this project, we examine the sex-related difference in kidney cortex gene expression profiles. We see that in GTEx kidney cortex RNA-seq data, male and female gene expression cannot be separated well by PCA. Using Wilcoxon rank sum test on each gene, we see that there are sex-related differential gene expression in kidney indicated by the small adjusted p-values. However, the amount of change in expression is small. In conclusion, there are differences in gene expression profiles of male and female kidneys, but these differences are not huge in magnitude."
  }
]